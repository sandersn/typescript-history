<div class="wikidoc">TypeScript uses a large set of compiler testcases to detect unexpected changes in the compiler behavior.<br />
<h1>Running the Tests</h1>To run all tests, invoke the <span class="codeInline">runtests</span> target using jake:<br /><pre>
jake runtests
</pre><br /><br />This will also include language service tests; to run only the compiler tests, add the flag:<br /><pre>
jake runtests tests=--compiler
</pre><br />
<h1>Adding a Test</h1>To add a new testcase, simply place a .ts file in <span class="codeInline">tests\cases\compiler</span> containing code that exemplifies the bugfix or change you are making.<br /><br />These files support metadata tags in the format <span class="codeInline"> // @name: value </span>. The supported names and values are:<br /> * <span class="codeInline">comments</span>, <span class="codeInline">sourcemap</span>, <span class="codeInline">noimplicitany</span>, <span class="codeInline">declaration</span>: <span class="codeInline">true</span> or <span class="codeInline">false</span> (corresponds to the compiler command-line options of the same name)<br /> * <span class="codeInline">target</span>: <span class="codeInline">ES3</span> or <span class="codeInline">ES5</span> (same as compiler)<br /> * <span class="codeInline">out</span>, <span class="codeInline">outDir</span>: <i>path</i> (same as compiler)<br /> * <span class="codeInline">module</span>: <span class="codeInline">local</span>, <span class="codeInline">commonjs</span>, or <span class="codeInline">amd</span> (<span class="codeInline">local</span> corresponds to not passing any compiler <span class="codeInline">--module</span> flag)<br /><br />Note that if you have a test corresponding to a specific spec compliance item, you can place it in <span class="codeInline">tests\cases\conformance</span> in an appropriately-named subfolder. Note that filenames here must be distinct from all other compiler testcase names, so you may have to work a bit to find a unique name if itâ€™s something common.<br />
<h1>Managing the Baselines</h1>Compiler testcases generate baselines that track the emitted .js, the errors produced by the compiler, and the type of each expression in the file. Additionally, some testcases opt in to baselining the source map output.<br /><br />When a change in the baselines is detected, the test will fail and a diff will be written to the file <span class="codeInline">baseline-report.html</span>. After verifying that the changes in the baselines are correct, run<br /><pre>
jake baseline-accept
</pre><br />to establish the new baselines as the desired behavior. This will change the files in <span class="codeInline">tests\baselines\reference</span>, which should be included as part of your commit. It&#39;s important to carefully validate changes in the baselines.<br /><br />Note that <span class="codeInline">baseline-accept</span> should only be run after a full test run! Accepting baselines after running a subset of tests will delete baseline files for the tests that didn&#39;t run.</div><div class="ClearBoth"></div>